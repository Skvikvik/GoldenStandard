<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:GoldenStandard.ViewModels"
             xmlns:models="clr-namespace:GoldenStandard.Models;assembly=GoldenStandard"
             xmlns:conv="clr-namespace:GoldenStandard.Converters"
             x:Class="GoldenStandard.Views.ProductListView"
             x:DataType="vm:ProductListViewModel">

	<UserControl.Resources>
		<conv:QualityColorConverter x:Key="QualityColorConverter"/>
	</UserControl.Resources>

	<Grid RowDefinitions="Auto, Auto, *" Background="#F5F5F5">

		<Border Grid.Row="0" Background="#3A3A3A" Padding="15">
			<Grid>
				<TextBlock Text="GOLDEN STANDARD" Foreground="#F0F0F0" LetterSpacing="2" FontWeight="Light" HorizontalAlignment="Left" VerticalAlignment="Center" FontSize="18"/>
				<Button HorizontalAlignment="Right" VerticalAlignment="Center" Background="Transparent"
                        Command="{Binding $parent[Window].((vm:MainViewModel)DataContext).ShowProfile}">
					<StackPanel Orientation="Horizontal" Spacing="8">
						<TextBlock Text="ðŸ‘¤" Foreground="White" FontSize="18"/>
						<TextBlock Text="ÐŸÑ€Ð¾Ñ„Ð¸Ð»ÑŒ" Foreground="White" VerticalAlignment="Center" FontSize="12"/>
					</StackPanel>
				</Button>
			</Grid>
		</Border>

		<Border Grid.Row="1" Background="#ECECEC" BorderBrush="#DCDCDC" BorderThickness="0,0,0,1" Padding="12">
			<Grid ColumnDefinitions="*, 220">
				<TextBox Grid.Column="0"
                         Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}"
                         Watermark="ÐŸÐ¾Ð¸ÑÐº Ñ‚Ð¾Ð²Ð°Ñ€Ð°..."
                         Background="White"
                         CornerRadius="5"
                         Margin="0,0,10,0"/>

				<ComboBox Grid.Column="1"
                          ItemsSource="{Binding SortModes}"
                          SelectedItem="{Binding SelectedSortMode}"
                          HorizontalAlignment="Stretch"/>
			</Grid>
		</Border>

		<ScrollViewer Grid.Row="2">
			<StackPanel Margin="10">
				<WrapPanel HorizontalAlignment="Center">
					<Button Command="{Binding GoToAddProduct}" Padding="5" Background="Transparent">
						<Border Background="White" Width="170" Height="220" CornerRadius="12" BorderBrush="Goldenrod" BorderThickness="2">
							<StackPanel VerticalAlignment="Center" HorizontalAlignment="Center" Spacing="10">
								<TextBlock Text="+" FontSize="60" Foreground="Goldenrod" HorizontalAlignment="Center"/>
								<TextBlock Text="ÐÐ¾Ð²Ñ‹Ð¹ Ñ‚Ð¾Ð²Ð°Ñ€" FontWeight="Bold" Foreground="#333333" HorizontalAlignment="Center"/>
							</StackPanel>
						</Border>
					</Button>

					<ItemsControl ItemsSource="{Binding Products}">
						<ItemsControl.ItemsPanel>
							<ItemsPanelTemplate>
								<WrapPanel Orientation="Horizontal"/>
							</ItemsPanelTemplate>
						</ItemsControl.ItemsPanel>
						<ItemsControl.ItemTemplate>
							<DataTemplate x:DataType="models:Product">
								<Button Background="Transparent" Padding="5"
                                        Command="{Binding $parent[UserControl].((vm:ProductListViewModel)DataContext).SelectProductCommand}"
                                        CommandParameter="{Binding}">
									<Border Background="White" Width="170" Height="220" CornerRadius="12" BoxShadow="0 2 5 0 #15000000">
										<Grid RowDefinitions="110, *">
											<Border Grid.Row="0" Background="#F9F9F9" CornerRadius="12,12,0,0">
												<Grid>
													<Image Source="/Assets/avalonia-logo.ico" Opacity="0.4" Margin="30"/>

													<Border HorizontalAlignment="Right" VerticalAlignment="Top" Margin="8" Padding="5,2"
															Background="White" CornerRadius="4"
															BorderBrush="{Binding QualityPercentage, Converter={StaticResource QualityColorConverter}}"
															BorderThickness="1">
														<TextBlock Text="{Binding QualityPercentage, StringFormat={}{0}%}"
																   FontSize="10"
																   FontWeight="Bold"
																   Foreground="{Binding QualityPercentage, Converter={StaticResource QualityColorConverter}}"/>
													</Border>
												</Grid>
											</Border>

											<StackPanel Grid.Row="1" Margin="10,5" Spacing="2">
												<TextBlock Text="{Binding Name}" FontWeight="Bold" FontSize="13" Height="34" TextWrapping="Wrap" TextTrimming="CharacterEllipsis"/>

												<StackPanel Orientation="Horizontal" Spacing="5">
													<TextBlock Text="â˜…" Foreground="Orange" FontSize="12"/>
													<TextBlock Text="{Binding Rating, StringFormat={}{0:N1}}" FontSize="12" FontWeight="Bold" VerticalAlignment="Center"/>
													<TextBlock Text="{Binding ReviewsCount, StringFormat='({0})'}" Foreground="#999999" FontSize="11" VerticalAlignment="Center"/>
												</StackPanel>

												<TextBlock Text="{Binding Price, StringFormat={}{0} â‚½}" Foreground="Goldenrod" FontWeight="Heavy" FontSize="15" Margin="0,2,0,0"/>
												<TextBlock Text="Ð’ Ð½Ð°Ð»Ð¸Ñ‡Ð¸Ð¸" FontSize="10" Foreground="#27AE60"/>
											</StackPanel>
										</Grid>
									</Border>
								</Button>
							</DataTemplate>
						</ItemsControl.ItemTemplate>
					</ItemsControl>
				</WrapPanel>

				<StackPanel Margin="0,20">
					<Button Command="{Binding LoadMoreCommand}" Content="ÐŸÐ¾ÐºÐ°Ð·Ð°Ñ‚ÑŒ ÐµÑ‰Ðµ" HorizontalAlignment="Center"
                            IsVisible="{Binding !IsBusy}" Background="#3A3A3A" Foreground="White" CornerRadius="5" Padding="20,10"/>
					<ProgressBar IsIndeterminate="True" IsVisible="{Binding IsBusy}" HorizontalAlignment="Center" Width="200" Foreground="Goldenrod"/>
				</StackPanel>
			</StackPanel>
		</ScrollViewer>
	</Grid>
</UserControl>